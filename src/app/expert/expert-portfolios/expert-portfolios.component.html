<div class="row topNavbar fixed-top">
    <div class="col-md-3 py-3">
        <img routerLink="/home" src="/assets/imgs/grayLogo.png" class="pointer ml-4">
    </div>
    <div class="col-md-9 text-right">
        <button (click)="navigatePage(btn.navigatePage)" *ngFor="let btn of tabButtons"
            [class.activeBtn]="activeTab===btn.title" class="btn btn-inactive grayChoiceHover">{{btn.title}}</button>
    </div>
</div>

<div class="parentContent bg-white">
    <div class="row justify-content-center">
        <div class="col-md-12 maxWidthContent">
            <div class="borderdSection p-4 mt-4">
                <div class="row">
                    <div class="col-md-12">
                        <p>Portfolio
                            <i *ngIf="expandPortfolios" (click)="expandPortfolios=false"
                                class="fas fa-angle-up float-right pointer"></i>
                            <i *ngIf="!expandPortfolios" (click)="expandPortfolios=true"
                                class="fas fa-angle-down float-right pointer"></i>
                        </p>
                    </div>
                </div>
                <div *ngIf="expandPortfolios" class="row">
                    <div class="col-md-12">
                        <h4 class="bold">Add your Projects</h4>
                        <p class="text-secondary">
                            Build your credibility by showcasing the projects you have completed
                        </p>

                        <div *ngIf="expertProfile.portfolio && expertProfile.portfolio.length">
                            <div *ngFor="let portfolio of expertProfile.portfolio; index as i"
                                class="educationBlock row">
                                <div class="col-md-10 pl-0">
                                    <h5>{{portfolio.title}}</h5>
                                    <p class="text-gray mb-0">{{portfolio.description}}</p>
                                    <p class="text-gray">
                                        {{portfolio.startMonth}} {{portfolio.startYear}} -
                                        {{portfolio.endMonth}} {{portfolio.endYear}}
                                    </p>
                                </div>
                                <div class="col-md-2 pr-0 text-center">
                                    <button (click)="editPortfolio(i)" data-toggle="modal"
                                        data-target="#addEditPortfolioModal" style="width: 100px;"
                                        class="btn btn-outline-info btn-sm my-2">Update</button>
                                    <br />
                                    <button data-toggle="modal" data-target="#deletePortfolioModal"
                                        (click)="removePortfolio(i)" style="width: 100px;"
                                        class="btn btn-outline-danger btn-sm">Delete</button>
                                </div>
                                <hr class="w-100 mt-0" />
                            </div>
                        </div>

                        <div (click)="newPortfolio()" data-toggle="modal" data-target="#addEditPortfolioModal"
                            style="width: fit-content" class="d-flex pointer mt-4">
                            <img class="addIcon m-0" src="/assets/imgs/add-icon.png">
                            <h5 class="bold mt-2 ml-3">Add Projects</h5>
                        </div>
                    </div>
                </div>
            </div>

            <div class="borderdSection p-4 mt-4">
                <div class="row">
                    <div class="col-md-12">
                        <p>Language
                            <i *ngIf="expandLanguages" (click)="expandLanguages=false"
                                class="fas fa-angle-up float-right pointer"></i>
                            <i *ngIf="!expandLanguages" (click)="expandLanguages=true"
                                class="fas fa-angle-down float-right pointer"></i>
                        </p>
                    </div>
                </div>
                <div *ngIf="expandLanguages" class="row">
                    <div class="col-md-12">
                        <h4 class="bold">What language are you fluent in?</h4>
                        <div *ngIf="expertProfile.languages" class="form-group mt-3" style="width: 30%">
                            <ng-select [multiple]="true" [(ngModel)]="expertProfile.languages"
                                [items]="dataHelper.languages" placeholder="Choose languages"></ng-select>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <div class="skillInputSection">
                            <h4 class="bold my-3">Do you know any other language? (optional)</h4>
                            <tag-input #input [modelAsStrings]="true" [placeholder]="'Add language'"
                                [secondaryPlaceholder]="'Add language'" [(ngModel)]="expertProfile.otherLanguages">
                                <tag-input-dropdown [showDropdownIfEmpty]="true"></tag-input-dropdown>
                            </tag-input>

                            <!-- <div class="inputContainer">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Type Language">
                                    <div class="input-group-append">
                                        <span class="input-group-text">
                                            <i class="fas fa-times text-danger pointer"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <input type="text" class="form-control soloInput" placeholder="Type Language">
                            <img class="addIcon pointer" src="/assets/imgs/add-icon.png"> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row fixed-bottom p-3 px-4 continueBackBtns">
    <div class="col-md-4">
        <button routerLink="/expert-overview" class="btn btn-light grayChoiceHover btnRounded">Back</button>
    </div>
    <div class="col-md-4 text-center">
        <p (click)="saveAndExit()" class="mb-0 mt-2 pointer">Save and Exit</p>
    </div>
    <div class="col-md-4 text-right">
        <button (click)="saveAndNext()" class="btn btnSecondary grayChoiceHover btnRounded">Continue</button>
    </div>
</div>


<div class="modal fade portfolioModal" id="addEditPortfolioModal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div [formGroup]="portfolioForm" class="modal-body p-4">
                <div class="form-group">
                    <label>Portfolio Title</label>
                    <input formControlName="title" type="text" placeholder="Title" class="form-control">
                    <p class="errorMsg" *ngIf="portfolioForm.get('title').hasError('required') && 
                    (portfolioForm.get('title').dirty || portfolioForm.get('title').touched)">
                        *This field is required
                    </p>
                </div>

                <div class="skillInputSection">
                    <label class="w-100">Skills</label>
                    <ng-select [items]="suggestedSkills" [multiple]="true" placeholder="Choose skills"
                        [(ngModel)]="skillList" [ngModelOptions]="{standalone:true}">
                    </ng-select>

                    <!-- <div class="inputContainer">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Type Skill">
                            <div class="input-group-append">
                                <span class="input-group-text">
                                    <i class="fas fa-times text-danger pointer"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control soloInput" placeholder="Type Skill">
                    <img class="addIcon pointer" src="/assets/imgs/add-icon.png"> -->
                </div>

                <label class="mt-3">Project Duration</label>
                <div class="row">
                    <div class="col-md-6 pl-0">
                        <div class="form-group">
                            <ng-select formControlName="startYear" [items]="years" placeholder="Start Year"></ng-select>
                            <p class="errorMsg" *ngIf="portfolioForm.get('startYear').hasError('required') && 
                            (portfolioForm.get('startYear').dirty || portfolioForm.get('startYear').touched)">
                                *This field is required
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 pr-0">
                        <div class="form-group">
                            <ng-select formControlName="endYear" [items]="endYears" placeholder="End Year"></ng-select>
                            <p class="errorMsg" *ngIf="portfolioForm.get('endYear').hasError('required') && 
                            (portfolioForm.get('endYear').dirty || portfolioForm.get('endYear').touched)">
                                *This field is required
                            </p>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea formControlName="description" type="text" placeholder="Label" class="form-control"
                        rows="5"></textarea>
                </div>

                <div class="form-group">
                    <label>Upload Files or Images</label>
                    <div *ngIf="portfolioObj.attachedFiles.length" class="form-group">
                        <button *ngFor="let file of portfolioObj.attachedFiles; index as i"
                            class="btn btn-light mr-3 mb-3">
                            <a [href]="file.url" target="_blank">{{file.name}}</a>
                            <i (click)="removeFile(i)" class="fa fa-trash text-danger ml-5"></i>
                        </button>
                    </div>

                    <input #portfolioImagePicker hidden [multiple]="true" (change)="onChangeFile($event)" type="file"
                        accept="image/*">
                    <div class="uploadPhotoContent rounded p-5 text-center">
                        <button (click)="portfolioImagePicker.click()" class="btn blackBgBtn btn-dark btnRounded mt-3">
                            Upload Photos <i class="fas fa-cloud-upload-alt"></i>
                        </button>
                        <p class="text-secondary mt-2">or drag them in
                            <span *ngIf="selectedFiles.length">
                                <br /> {{selectedFiles.length}} New file(s) attached
                            </span>
                        </p>
                    </div>
                </div>

                <div class="form-group">
                    <label>Link to Project (optional)</label>
                    <input formControlName="projectLink" type="text" class="form-control"
                        placeholder="Type in link that showcase your project">
                    <p class="errorMsg" *ngIf="portfolioForm.get('projectLink').hasError('required') && 
                            (portfolioForm.get('projectLink').dirty || portfolioForm.get('projectLink').touched)">
                        *This field is required
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-md-6">
                    <button id="closePortfolioModalButton" data-dismiss="modal"
                        class="btn cancelBtn btnRounded whiteOutlinedBtn px-4">Cancel</button>
                </div>
                <div class="col-md-6 text-right">
                    <button (click)="saveThisPortfolio(portfolioForm.value)"
                        [disabled]="!portfolioForm.valid || !skillList.length"
                        class="btn blackBgBtn btn-dark btnRounded px-4">Save
                        and Exit</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="deletePortfolioModal">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <h4 class="modal-title">Remove Portfolio</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body">
                Are you sure you want to remove this portfolio?
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button (click)="removePortfolioObject()" type="button" class="btn btn-danger"
                    data-dismiss="modal">Remove</button>
            </div>
        </div>
    </div>
</div>