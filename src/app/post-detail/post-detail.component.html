<app-navbar></app-navbar>
<ngx-loading [show]="loading"></ngx-loading>

<div class="pagesLog">
  <img src="/assets/imgs/M-Logo.PNG" height="25px">
  <i class="fas fa-chevron-right lightGray px-3"></i>
  <p class="bold my-0">Browse</p>
  <i class="fas fa-chevron-right lightGray px-3"></i>
  <p class="bold my-0">Job Detail</p>
</div>

<div class="row mainCont">
  <div class="col-sm-12 maxWidthContent">
    <div *ngIf="jobDetails.status==='Closed'" class="card expInfo">
      <div class="d-flex">
        <i class="fas fa-info-circle subTitle"></i>
        <h5 class="text1 bold mb-0 align-center font-18 pl-3">This job is closed and no longer accepting proposals</h5>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-8 pr-4 pl-0">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="post-tab" data-toggle="tab" href="#post" role="tab" aria-controls="post"
              aria-selected="true">View Job Post</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="invite-tab" data-toggle="tab" href="#invite" role="tab" aria-controls="invite"
              aria-selected="true">Invite Experts ({{bestMatchExperts.length}})</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="proposal-tab" data-toggle="tab" href="#proposal" role="tab" aria-controls="proposal"
              aria-selected="false">Review Proposals ({{pendingBids.length}})</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="acceptedJobs-tab" data-toggle="tab" href="#acceptedJobs" role="tab"
              aria-controls="acceptedJobs" aria-selected="false">Active Jobs ({{acceptedBids.length}})</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="completedJobs-tab" data-toggle="tab" href="#completedJobs" role="tab"
              aria-controls="completedJobs" aria-selected="false">Completed Jobs ({{completedBids.length}})</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="tab-content" id="myTabContent">

      <div class="tab-pane fade show active" id="post" role="tabpanel" aria-labelledby="post-tab">
        <div class="card jobDetailCont">
          <div class="header">
            <h4 class="mb-0 bold">Job Details</h4>
          </div>
          <div class="detailsCont">
            <h5 class="mb-1 bold">{{jobDetails.jobTitle}}</h5>
            <p class="font-14 mb-0 text1">Posted {{jobDetails.timestamp | date: 'mediumDate'}}</p>
            <p class="font-13 my-3">{{jobDetails.description}}</p>
            <div class="d-flex pricesDetail">
              <div class="txt">
                <p class="mb-1 bold">Project Type</p>
                <p class="font-13 mb-0">{{jobDetails.jobType}}</p>
              </div>
            </div>

            <div *ngIf="jobDetails.questions">
              <h5 class="mb-1 bold">You will be asked to answer the following questions</h5>
              <p *ngFor="let question of jobDetails.questions; index as i" class="font-13 mb-0 text1">
                {{i+1}}: {{question}}
              </p>
            </div>

            <div class="skillsBtnCont">
              <h5 class="mb-1 bold ">Skills and Expertise</h5>
              <button *ngFor="let skill of jobDetails.skills" class="btn skillBtn">{{skill}}</button>
            </div>

            <div *ngIf="jobDetails.languages">
              <h5 class="mb-1 bold ">Preferred Languages</h5>
              <p *ngFor="let language of jobDetails.languages" class="font-13 mb-0">{{language}}</p>
            </div>

            <h5 class="mb-1 bold mt-5">Activity on this Job</h5>
            <p class="font-13 mb-1">Bids: {{jobDetails.bids?.length || 0}}</p>
            <p class="font-13 mb-0">Hired: <span class="blueTxt"><u>
                  {{jobDetails.hired? jobDetails.hired.length : 0}}
                </u></span></p>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="invite" role="tabpanel" aria-labelledby="invite-tab">
        <div *ngFor="let expert of bestMatchExperts; index as i" class="card expertCard">
          <div class="expertDetailCont">
            <i class="far fa-heart likeIcon"></i>
            <div (click)="userDetails(expert)" class="d-flex pointer">
              <img [src]="expert.profileUrl || '/assets/imgs/userIcon.PNG'" class="expertImg">
              <div class="txt pl-3 align-center">
                <h5 class="mb-1">{{expert.fullName}}</h5>
                <p class="font-14 bold my-0">{{expert.expertProfile?.overview?.title || 'N/A'}}</p>
              </div>
            </div>
            <p class="font-13 text1 my-3">{{expert.expertProfile?.overview?.overview || 'N/A'}}</p>
            <div class="subCategCont">
              <button *ngFor="let skill of getAllSkills(expert) | slice:0:3" class="btn tagBtn">{{skill}}</button>
              <button (click)="userDetails(expert)" *ngIf="getAllSkills(expert).length > 3"
                class="btn tagBtn moreBtn">+{{getAllSkills(expert).length-3}} more</button>
            </div>
          </div>
          <div class="row expertContactCont">
            <div class="col-sm-2 px-0 pointer">
              <p class="bold font-15 mb-0">Part of Hub</p>
              <p class="font-13 mb-0">{{getExpertAgency(expert) || 'N/A'}}</p>
            </div>
            <div class="col-sm-3 text-center align-center">
              <p class="bold font-15 mb-0">
                RM {{expert.expertProfile?.hourlyRate?.hourlyRate | number:'1.0-0' || 'N/A'}}/hr
              </p>
            </div>
            <div class="col-sm-2 px-0 text-center align-center">
              <p class="bold font-15 mb-0">{{expert.location?.country || 'N/A'}}</p>
            </div>
            <div class="col-sm-2 px-0 text-center align-center">
              <p class="bold font-15 mb-0 pt-2" style="line-height: 8px;">{{expert.rating || 0}}/5</p>
              <div class="rating">
                <i class="fas fa-star text-secondary" [class.text-warning]="expert.rating && expert.rating >=1"></i>
                <i class="fas fa-star text-secondary" [class.text-warning]="expert.rating && expert.rating >=2"></i>
                <i class="fas fa-star text-secondary" [class.text-warning]="expert.rating && expert.rating >=3"></i>
                <i class="fas fa-star text-secondary" [class.text-warning]="expert.rating && expert.rating >=4"></i>
                <i class="fas fa-star text-secondary" [class.text-warning]="expert.rating && expert.rating === 5"></i>
              </div>
            </div>
            <div class="col-sm-3 align-center pl-4">
              <button [disabled]="!alreadyInvitedOrApplied(expert)" (click)="inviteToJob(expert)"
                class="btn darkBtn btn-block">Invite to job</button>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="proposal" role="tabpanel" aria-labelledby="proposal-tab">
        <app-review-proposals *ngIf="bidsFetched" [jobBidsList]="pendingBids" [jobDetails]="jobDetails">
        </app-review-proposals>
      </div>

      <div class="tab-pane fade" id="acceptedJobs" role="tabpanel" aria-labelledby="acceptedJobs-tab">
        <app-active-jobs *ngIf="bidsFetched" [acceptedBids]="acceptedBids" [jobDetails]="jobDetails">
        </app-active-jobs>
      </div>

      <div class="tab-pane fade" id="completedJobs" role="tabpanel" aria-labelledby="completedJobs-tab">
        <app-active-jobs *ngIf="bidsFetched" [acceptedBids]="completedBids" [jobDetails]="jobDetails">
        </app-active-jobs>
      </div>

    </div>

  </div>
</div>

<app-footer></app-footer>